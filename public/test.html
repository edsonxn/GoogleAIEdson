<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Estilos Personalizados</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #1a1a2e;
            color: white;
        }
        .test-btn { 
            background: #00bfff; 
            color: white; 
            padding: 10px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 10px;
        }
        .test-btn:hover { background: #0099cc; }
        #results { 
            background: #2a2a4a; 
            padding: 15px; 
            margin-top: 20px; 
            border-radius: 5px;
        }
        select { 
            padding: 8px; 
            margin: 10px; 
            background: #2a2a4a; 
            color: white; 
            border: 1px solid #00bfff;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>üß™ Test de Estilos Personalizados</h1>
    
    <div>
        <h3>Selector de Estilos:</h3>
        <select id="testStyleSelect">
            <option value="professional">Profesional</option>
            <option value="comedy">C√≥mico</option>
        </select>
    </div>
    
    <div>
        <button class="test-btn" onclick="testLocalStorage()">üîç Verificar localStorage</button>
        <button class="test-btn" onclick="createTestStyle()">‚ûï Crear Estilo de Prueba</button>
        <button class="test-btn" onclick="loadAndUpdateSelector()">üîÑ Cargar y Actualizar Selector</button>
        <button class="test-btn" onclick="clearAll()">üóëÔ∏è Limpiar Todo</button>
    </div>
    
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        const styleSelect = document.getElementById('testStyleSelect');
        
        function log(message) {
            results.innerHTML += '<div>' + new Date().toLocaleTimeString() + ' - ' + message + '</div>';
            console.log(message);
        }
        
        function testLocalStorage() {
            log('üîç Verificando localStorage...');
            const saved = localStorage.getItem('customScriptStyles');
            log('üì¶ Contenido: ' + (saved || 'VAC√çO'));
            
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    log('üìù Estilos encontrados: ' + parsed.length);
                    parsed.forEach((style, index) => {
                        log(`  ${index + 1}. ${style.name} (${style.id})`);
                    });
                } catch (error) {
                    log('‚ùå Error parseando JSON: ' + error.message);
                }
            }
        }
        
        function createTestStyle() {
            log('‚ûï Creando estilo de prueba...');
            
            const testStyle = {
                id: `custom_${Date.now()}`,
                name: 'Estilo Test ' + Date.now(),
                description: 'Un estilo de prueba',
                instructions: 'Usa un tono casual y divertido'
            };
            
            let customStyles = [];
            const saved = localStorage.getItem('customScriptStyles');
            if (saved) {
                try {
                    customStyles = JSON.parse(saved);
                } catch (error) {
                    log('‚ùå Error cargando estilos existentes');
                }
            }
            
            customStyles.push(testStyle);
            localStorage.setItem('customScriptStyles', JSON.stringify(customStyles));
            
            log('‚úÖ Estilo creado: ' + testStyle.name);
            log('üíæ Total de estilos: ' + customStyles.length);
        }
        
        function loadAndUpdateSelector() {
            log('üîÑ Cargando y actualizando selector...');
            
            const saved = localStorage.getItem('customScriptStyles');
            if (!saved) {
                log('üì≠ No hay estilos guardados');
                return;
            }
            
            try {
                const customStyles = JSON.parse(saved);
                log('üìù Estilos cargados: ' + customStyles.length);
                
                // Limpiar selector
                styleSelect.innerHTML = '';
                
                // Agregar opciones predeterminadas
                const profOption = document.createElement('option');
                profOption.value = 'professional';
                profOption.textContent = 'Profesional';
                styleSelect.appendChild(profOption);
                
                const comedyOption = document.createElement('option');
                comedyOption.value = 'comedy';
                comedyOption.textContent = 'C√≥mico';
                styleSelect.appendChild(comedyOption);
                
                // Agregar estilos personalizados
                customStyles.forEach(style => {
                    const option = document.createElement('option');
                    option.value = style.id;
                    option.textContent = style.name + ' (Personalizado)';
                    styleSelect.appendChild(option);
                    log('üé® Agregado al selector: ' + style.name);
                });
                
                log('‚úÖ Selector actualizado con ' + styleSelect.options.length + ' opciones');
                
            } catch (error) {
                log('‚ùå Error procesando estilos: ' + error.message);
            }
        }
        
        function clearAll() {
            log('üóëÔ∏è Limpiando localStorage...');
            localStorage.removeItem('customScriptStyles');
            
            // Resetear selector
            styleSelect.innerHTML = `
                <option value="professional">Profesional</option>
                <option value="comedy">C√≥mico</option>
            `;
            
            log('‚úÖ Todo limpiado');
        }
        
        // Ejecutar test inicial
        window.addEventListener('load', function() {
            log('üöÄ P√°gina de test cargada');
            testLocalStorage();
        });
    </script>
</body>
</html>
